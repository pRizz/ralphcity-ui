---
phase: 07-agent-orchestrator-selection
plan: 02
type: execute
wave: 2
depends_on: ["07-01"]
files_modified:
  - frontend/src/api/types.ts
  - frontend/src/components/ralphtown/OrchestratorSelector.tsx
  - frontend/src/components/ralphtown/MainPanel.tsx
  - frontend/src/pages/Index.tsx
autonomous: true

must_haves:
  truths:
    - "User can see orchestrator dropdown when starting a new session"
    - "Ralph is selected by default in the orchestrator selector"
    - "GSD and Gastown options are visible but disabled with Coming Soon badge"
    - "Selected orchestrator is passed to session creation API"
  artifacts:
    - path: "frontend/src/api/types.ts"
      provides: "OrchestratorType union type and updated Session/CreateSessionRequest interfaces"
      contains: "OrchestratorType"
    - path: "frontend/src/components/ralphtown/OrchestratorSelector.tsx"
      provides: "OrchestratorSelector dropdown component"
      exports: ["OrchestratorSelector"]
    - path: "frontend/src/components/ralphtown/MainPanel.tsx"
      provides: "OrchestratorSelector rendered above PromptInput"
      contains: "OrchestratorSelector"
    - path: "frontend/src/pages/Index.tsx"
      provides: "Orchestrator state passed through to session creation"
      contains: "orchestrator"
  key_links:
    - from: "frontend/src/components/ralphtown/MainPanel.tsx"
      to: "frontend/src/components/ralphtown/OrchestratorSelector.tsx"
      via: "component import and render"
      pattern: "OrchestratorSelector"
    - from: "frontend/src/pages/Index.tsx"
      to: "frontend/src/api/hooks.ts"
      via: "createSession mutation with orchestrator"
      pattern: "createSession.*orchestrator"
---

<objective>
Add orchestrator selection UI to the frontend session creation flow.

Purpose: Users can select which AI orchestrator to use when starting a new session. Ralph is available, GSD and Gastown are shown as "Coming Soon".

Output: OrchestratorSelector component integrated into the session start flow, with selection passed to backend.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/07-agent-orchestrator-selection/07-RESEARCH.md
@.planning/phases/07-agent-orchestrator-selection/07-01-SUMMARY.md

# Existing patterns and components
@frontend/src/api/types.ts - Session and CreateSessionRequest types to update
@frontend/src/components/ralphtown/PromptInput.tsx - Model dropdown pattern reference
@frontend/src/components/ralphtown/MainPanel.tsx - Where to add selector
@frontend/src/pages/Index.tsx - handleStartSession flow
@frontend/src/components/ui/select.tsx - shadcn Select component
@frontend/src/components/ui/badge.tsx - shadcn Badge component
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add OrchestratorType to frontend types</name>
  <files>frontend/src/api/types.ts</files>
  <action>
1. Add OrchestratorType union type near the top of the file (after the Errors section, before Sessions):
   ```typescript
   // --- Orchestrator ---
   export type OrchestratorType = "ralph" | "gsd" | "gastown";
   ```

2. Update the Session interface to include orchestrator:
   ```typescript
   export interface Session {
     id: string;
     repo_id: string;
     name: string | null;
     orchestrator: OrchestratorType;  // Add this after name
     status: SessionStatus;
     created_at: string;
     updated_at: string;
   }
   ```

3. Update CreateSessionRequest to include optional orchestrator:
   ```typescript
   export interface CreateSessionRequest {
     repo_id: string;
     name?: string;
     orchestrator?: OrchestratorType;  // Add this - optional since backend defaults to ralph
   }
   ```

4. Update SessionDetails similarly if it exists (it flattens Session, so may already inherit).
  </action>
  <verify>
`npm run type-check` (or `npx tsc --noEmit`) in frontend directory passes
  </verify>
  <done>
OrchestratorType exists. Session includes orchestrator. CreateSessionRequest accepts optional orchestrator.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create OrchestratorSelector component</name>
  <files>frontend/src/components/ralphtown/OrchestratorSelector.tsx</files>
  <action>
Create a new file OrchestratorSelector.tsx with:

1. Import shadcn components: Select, SelectContent, SelectItem, SelectTrigger, SelectValue from @/components/ui/select
2. Import Badge from @/components/ui/badge
3. Import lucide icons: Bot, Sparkles, Users
4. Import OrchestratorType from @/api/types

5. Define OrchestratorInfo interface and ORCHESTRATORS constant array:
   ```typescript
   interface OrchestratorInfo {
     id: OrchestratorType;
     name: string;
     description: string;
     available: boolean;
     icon: React.ReactNode;
   }

   const ORCHESTRATORS: OrchestratorInfo[] = [
     { id: "ralph", name: "Ralph", description: "Autonomous coding agent", available: true, icon: <Bot className="h-4 w-4" /> },
     { id: "gsd", name: "GSD", description: "Task-driven orchestrator", available: false, icon: <Sparkles className="h-4 w-4" /> },
     { id: "gastown", name: "Gastown", description: "Multi-agent coordination", available: false, icon: <Users className="h-4 w-4" /> },
   ];
   ```

6. Create OrchestratorSelectorProps interface with value and onChange props

7. Create OrchestratorSelector component that:
   - Uses shadcn Select component
   - Shows current selection in trigger
   - Renders all orchestrators in content
   - Disabled orchestrators have `disabled` prop set
   - Disabled orchestrators show "Coming Soon" Badge inline
   - Each item shows icon + name + optional badge

Style the trigger width to w-[180px] or similar. Match existing UI patterns.
  </action>
  <verify>
File exists and exports OrchestratorSelector. `npm run type-check` passes.
  </verify>
  <done>
OrchestratorSelector component exists with Ralph enabled, GSD/Gastown disabled with Coming Soon badges.
  </done>
</task>

<task type="auto">
  <name>Task 3: Integrate OrchestratorSelector into session creation flow</name>
  <files>frontend/src/components/ralphtown/MainPanel.tsx, frontend/src/pages/Index.tsx</files>
  <action>
In MainPanel.tsx:

1. Add import for OrchestratorSelector
2. Add import for OrchestratorType from @/api/types
3. Update MainPanelProps to include:
   - selectedOrchestrator: OrchestratorType
   - onSelectOrchestrator: (value: OrchestratorType) => void
4. Update onStartSession signature to include orchestrator parameter:
   `onStartSession: (prompt: string, repo: Repository, branch: string, model: string, orchestrator: OrchestratorType) => void`
5. Update handleSubmit to pass orchestrator:
   `onStartSession(prompt, selectedRepo, selectedBranch, model, selectedOrchestrator)`
6. Add OrchestratorSelector between RepoSelector and PromptInput in the main section:
   ```tsx
   <OrchestratorSelector
     value={selectedOrchestrator}
     onChange={onSelectOrchestrator}
   />
   ```

In Index.tsx:

1. Add import for OrchestratorType
2. Add state: `const [selectedOrchestrator, setSelectedOrchestrator] = useState<OrchestratorType>("ralph")`
3. Update handleStartSession signature to accept orchestrator parameter
4. Pass orchestrator to createSession mutation:
   ```typescript
   const session = await createSession.mutateAsync({
     repo_id: repo.id,
     name: prompt.length > 30 ? prompt.slice(0, 30) + "..." : prompt,
     orchestrator,
   });
   ```
5. Pass selectedOrchestrator and setSelectedOrchestrator to MainPanel:
   ```tsx
   <MainPanel
     ...
     selectedOrchestrator={selectedOrchestrator}
     onSelectOrchestrator={setSelectedOrchestrator}
     ...
   />
   ```
  </action>
  <verify>
`npm run build` in frontend directory completes successfully. Start the app and verify:
1. OrchestratorSelector appears above the prompt input
2. Ralph is selected by default
3. GSD/Gastown are visible but cannot be selected
4. Starting a session works correctly
  </verify>
  <done>
OrchestratorSelector is visible in UI. Ralph is default. GSD/Gastown are disabled. Selected orchestrator is passed to session creation API.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` in frontend directory succeeds
2. Start the app (frontend + backend)
3. Visual verification:
   - Navigate to main page
   - Verify OrchestratorSelector appears between repo selector and prompt input
   - Verify Ralph is selected by default
   - Click the selector - verify GSD and Gastown show "Coming Soon" badge
   - Verify GSD/Gastown cannot be selected (disabled)
4. Functional verification:
   - Enter a prompt and start a session
   - Verify session is created successfully
   - Check network tab - verify orchestrator is in the request body
</verification>

<success_criteria>
- OrchestratorSelector component renders correctly
- Ralph is default selected orchestrator
- GSD and Gastown show as disabled with "Coming Soon" badge
- Starting a session passes orchestrator to backend
- No TypeScript errors or build failures
</success_criteria>

<output>
After completion, create `.planning/phases/07-agent-orchestrator-selection/07-02-SUMMARY.md`
</output>
